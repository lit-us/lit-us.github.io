<html>
<head>
    <title>科学计算器</title>
    <script>
        function calculate() {
            try {
                var formula = document.getElementById('formula').value;
                var resultDiv = document.getElementById('result');
                
                if (!formula) {
                    resultDiv.innerHTML = "请输入计算公式";
                    return;
                }
                
                // 替换数学函数和运算符
                var expr = formula
                    .replace(/\^/g, '**')
                    .replace(/sqrt\(/g, 'Math.sqrt(')
                    .replace(/sin\(/g, 'Math.sin(')
                    .replace(/cos\(/g, 'Math.cos(')
                    .replace(/tan\(/g, 'Math.tan(')
                    .replace(/log\(/g, 'Math.log10(')
                    .replace(/ln\(/g, 'Math.log(')
                    .replace(/abs\(/g, 'Math.abs(')
                    .replace(/pi/g, 'Math.PI')
                    .replace(/e\b/g, 'Math.E');
                
                // 计算并显示结果
                var result = eval(expr);
                resultDiv.innerHTML = "结果: " + result;
            } catch (e) {
                document.getElementById('result').innerHTML = "错误: " + e.message;
            }
            return false;
        }
        
        // 页面加载后初始化
        window.onload = function() {
            // 支持按Enter键计算
            document.getElementById('formula').onkeypress = function(e) {
                e = e || window.event;
                if (e.keyCode === 13) {
                    calculate();
                    return false;
                }
            };
        };
    </script>
</head>
<body>
    <h1>科学计算器</h1>
    <p>输入数学公式（如sqrt(3)+5*2）：</p>
    <form onsubmit="return calculate();">
        <input type="text" id="formula" size="40">
        <button type="button" onclick="calculate();">计算</button>
    </form>
    <div id="result"></div>
</body>
</html>
